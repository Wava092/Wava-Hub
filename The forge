-- Настройки
local Settings = {
    Key = "638VKEV92S99733", -- ТВОЙ КЛЮЧ (Поменяй на нужный)
    KeyLink = "https://go.linkify.ru/2Efy", -- ССЫЛКА НА ПОЛУЧЕНИЕ КЛЮЧА
    ScriptToRun = function()
        -- Сюда вставляем скрипт, который запустится после верного ключа
        loadstring(game:HttpGet("https://raw.githubusercontent.com/jokerbiel13/FourHub/refs/heads/main/TheForgeFH.lua",true))()
    end
}

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

-- Защита от повторного запуска (удаляем старый GUI если есть)
if CoreGui:FindFirstChild("PurpleKeySystem") then
    CoreGui.PurpleKeySystem:Destroy()
end

-- Создание GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PurpleKeySystem"
ScreenGui.Parent = CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Главный фрейм (Окно)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25) -- Темный фон
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.Size = UDim2.new(0, 0, 0, 0) -- Начальный размер 0 для анимации
MainFrame.ClipsDescendants = true
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 15)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Parent = MainFrame
UIStroke.Color = Color3.fromRGB(140, 0, 255) -- Фиолетовая обводка
UIStroke.Thickness = 2
UIStroke.Transparency = 0.5

-- Анимация открытия
TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {Size = UDim2.new(0, 400, 0, 280)}):Play()

-- Заголовок
local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1.000
Title.Position = UDim2.new(0, 20, 0, 15)
Title.Size = UDim2.new(0, 200, 0, 30)
Title.Font = Enum.Font.GothamBold
Title.Text = "KEY SYSTEM"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 22.000
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Кнопка закрытия (Крестик)
local CloseBtn = Instance.new("TextButton")
CloseBtn.Name = "CloseBtn"
CloseBtn.Parent = MainFrame
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.BackgroundTransparency = 1.000
CloseBtn.Position = UDim2.new(1, -40, 0, 15)
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(180, 180, 180)
CloseBtn.TextSize = 20.000

-- Поле ввода ключа
local KeyInput = Instance.new("TextBox")
KeyInput.Name = "KeyInput"
KeyInput.Parent = MainFrame
KeyInput.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
KeyInput.Position = UDim2.new(0.5, -170, 0, 70)
KeyInput.Size = UDim2.new(0, 340, 0, 45)
KeyInput.Font = Enum.Font.Gotham
KeyInput.PlaceholderText = "Введите ключ здесь..."
KeyInput.Text = ""
KeyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
KeyInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
KeyInput.TextSize = 16.000

local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0, 8)
InputCorner.Parent = KeyInput

-- Функция для создания красивых кнопок
local function CreateButton(name, text, pos, callback)
    local Button = Instance.new("TextButton")
    Button.Name = name
    Button.Parent = MainFrame
    Button.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    Button.Position = pos
    Button.Size = UDim2.new(0, 160, 0, 40)
    Button.Font = Enum.Font.GothamBold
    Button.Text = text
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = 14.000
    Button.AutoButtonColor = false

    local BtnCorner = Instance.new("UICorner")
    BtnCorner.CornerRadius = UDim.new(0, 8)
    BtnCorner.Parent = Button
    
    local BtnStroke = Instance.new("UIStroke")
    BtnStroke.Parent = Button
    BtnStroke.Color = Color3.fromRGB(140, 0, 255)
    BtnStroke.Thickness = 1
    BtnStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

    -- Эффекты наведения
    Button.MouseEnter:Connect(function()
        TweenService:Create(Button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(140, 0, 255)}):Play()
    end)
    Button.MouseLeave:Connect(function()
        TweenService:Create(Button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(40, 40, 45)}):Play()
    end)
    
    Button.MouseButton1Click:Connect(function()
        -- Анимация клика
        local originalSize = UDim2.new(0, 160, 0, 40)
        local shrinkSize = UDim2.new(0, 150, 0, 38)
        
        local tween1 = TweenService:Create(Button, TweenInfo.new(0.05), {Size = shrinkSize})
        tween1:Play()
        tween1.Completed:Wait()
        TweenService:Create(Button, TweenInfo.new(0.05), {Size = originalSize}):Play()
        
        callback()
    end)
    
    return Button
end

-- Кнопка "Check Key" (Проверить) - Большая кнопка внизу
local CheckBtn = CreateButton("CheckKey", "ПРОВЕРИТЬ КЛЮЧ", UDim2.new(0.5, -80, 0, 210), function()
    if KeyInput.Text == Settings.Key then
        -- Анимация успеха
        KeyInput.TextColor3 = Color3.fromRGB(0, 255, 0)
        KeyInput.Text = "УСПЕШНО!"
        wait(1)
        
        -- Закрытие меню
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Size = UDim2.new(0,0,0,0)}):Play()
        wait(0.5)
        ScreenGui:Destroy()
        
        -- Запуск скрипта
        Settings.ScriptToRun()
    else
        -- Анимация ошибки
        local originalColor = Color3.fromRGB(35, 35, 40)
        local errorColor = Color3.fromRGB(255, 50, 50)
        
        KeyInput.Text = "НЕВЕРНЫЙ КЛЮЧ"
        KeyInput.TextColor3 = errorColor
        
        -- Тряска
        for i = 1, 5 do
            KeyInput.Position = KeyInput.Position + UDim2.new(0, 5, 0, 0)
            wait(0.05)
            KeyInput.Position = KeyInput.Position - UDim2.new(0, 5, 0, 0)
            wait(0.05)
        end
        
        wait(1)
        KeyInput.Text = ""
        KeyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
    end
end)

-- Кнопка "Get Key" (Получить ссылку)
local GetKeyBtn = CreateButton("GetKey", "ПОЛУЧИТЬ КЛЮЧ", UDim2.new(0.5, -170, 0, 140), function()
    setclipboard(Settings.KeyLink)
    -- Временная смена текста кнопки
    local btn = MainFrame:FindFirstChild("GetKey")
    if btn then
        local oldText = btn.Text
        btn.Text = "ССЫЛКА СКОПИРОВАНА!"
        wait(2)
        btn.Text = oldText
    end
end)

-- Кнопка "How to get key" (Инструкция/Ссылка)
local TutorialBtn = CreateButton("Tutorial", "КАК ПОЛУЧИТЬ КЛЮЧ?", UDim2.new(0.5, 10, 0, 140), function()
    setclipboard("https://t.me/Bisnesman/4") -- Обычно это та же ссылка или ссылка на видео
    local btn = MainFrame:FindFirstChild("Tutorial")
    if btn then
        local oldText = btn.Text
        btn.Text = "СКОПИРОВАНО!"
        wait(2)
        btn.Text = oldText
    end
end)


-- Логика кнопки Закрыть
CloseBtn.MouseEnter:Connect(function()
    TweenService:Create(CloseBtn, TweenInfo.new(0.2), {TextColor3 = Color3.fromRGB(255, 50, 50)}):Play()
end)
CloseBtn.MouseLeave:Connect(function()
    TweenService:Create(CloseBtn, TweenInfo.new(0.2), {TextColor3 = Color3.fromRGB(180, 180, 180)}):Play()
end)
CloseBtn.MouseButton1Click:Connect(function()
    TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Size = UDim2.new(0,0,0,0)}):Play()
    wait(0.5)
    ScreenGui:Destroy()
end)

-- Делаем окно перетаскиваемым (Draggable)
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

MainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)
